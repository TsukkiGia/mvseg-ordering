version: 1

# Example recipe: compare Random ordering vs MSE-proximity ordering.
#
# Dry run (prints planned runs without executing):
#   python -m experiments.tools.exp_yaml_launcher --config experiments/recipes/random_v_MSE/example_random_vs_mse.yaml
#
# Execute:
#   python -m experiments.tools.exp_yaml_launcher --config experiments/recipes/random_v_MSE/acdc_random_vs_mse.yaml --run
#
# Notes:
# - Each entry under `policies` becomes its own subfolder under `script_dir`, using
#   the `name` field from the referenced ordering-config YAML.
# - Plan B samples disjoint subsets of size `plan_b_subset_size` from the dataset.

defaults:
  prompt_config_path: experiments/prompt_generator_configs/click_prompt_generator.yml
  prompt_config_key: click_generator
  prompt_iterations: 20
  plan_b_subset_size: 10
  use_mega_dataset: true
  mega_dataset_name: ACDC
  mega_dataset_split: train

  # Runtime
  no_visualize: true
  device: cuda
  shards: 4
  experiment_seed: 23

experiments:
  - name: pretrained_baseline_random_vs_mse
    pretrained_model_score_goal: true
    commit_ground_truth: false
    script_dir: experiments/scripts/random_v_MSE/experiment_acdc/pretrained_baseline
    plan: [B]
    policies:
      - ordering_config_path: experiments/ordering_configs/random_default.yaml
      - ordering_config_path: experiments/ordering_configs/mse_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_max.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_max.yaml

# v2 means random sampling instead of disjoint sampling
  - name: pretrained_baseline_random_vs_mse_v2
    pretrained_model_score_goal: true
    commit_ground_truth: false
    script_dir: experiments/scripts/random_v_MSE_v2/experiment_acdc/pretrained_baseline
    plan_b_num_subsets: 10
    plan: [B]
    policies:
      - ordering_config_path: experiments/ordering_configs/random_default.yaml
      - ordering_config_path: experiments/ordering_configs/mse_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_max.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_max.yaml

  # 15p, 10p, 5p are ablations to understand variance at different policies
  - name: 15p
    pretrained_model_score_goal: true
    prompt_iterations: 15
    commit_ground_truth: false
    script_dir: experiments/scripts/random_v_MSE_v2/experiment_acdc/pretrained_baseline15p
    plan_b_num_subsets: 10
    plan: [B]
    policies:
      - ordering_config_path: experiments/ordering_configs/random_default.yaml
      - ordering_config_path: experiments/ordering_configs/mse_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_max.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_max.yaml

  - name: 10p
    pretrained_model_score_goal: true
    prompt_iterations: 10
    commit_ground_truth: false
    script_dir: experiments/scripts/random_v_MSE_v2/experiment_acdc/pretrained_baseline10p
    plan_b_num_subsets: 10
    plan: [B]
    policies:
      - ordering_config_path: experiments/ordering_configs/random_default.yaml
      - ordering_config_path: experiments/ordering_configs/mse_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_max.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_max.yaml
  
  - name: 5p
    pretrained_model_score_goal: true
    prompt_iterations: 5
    commit_ground_truth: false
    script_dir: experiments/scripts/random_v_MSE_v2/experiment_acdc/pretrained_baseline5p
    plan_b_num_subsets: 10
    plan: [B]
    policies:
      - ordering_config_path: experiments/ordering_configs/random_default.yaml
      - ordering_config_path: experiments/ordering_configs/mse_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_max.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_max.yaml


  # suggestion to explore 5p with subset size 5 but this uses disjoint subsets
  - name: pretrained_5p_5ss
    pretrained_model_score_goal: true
    prompt_iterations: 5
    plan_b_subset_size: 5
    commit_ground_truth: false
    script_dir: experiments/scripts/random_v_MSE/experiment_acdc/pretrained_5p_5ss
    plan: [B]
    policies:
      - ordering_config_path: experiments/ordering_configs/random_default.yaml
      - ordering_config_path: experiments/ordering_configs/mse_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_max.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_min.yaml
      - ordering_config_path: experiments/ordering_configs/mse_alternate_start_max.yaml
